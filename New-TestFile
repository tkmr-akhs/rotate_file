function New-TestFile {
    [CmdletBinding(SupportsShouldProcess = $true, ConfirmImpact = 'Medium')]
    param(
        [Parameter(Mandatory = $true, Position = 0)]
        [string]$Prefix,

        [Parameter(Mandatory = $true, Position = 1)]
        [AllowEmptyString()]
        [string]$Suffix,

        [Parameter(Mandatory = $true, Position = 2)]
        [int]$Start,

        [Parameter(Mandatory = $true, Position = 3)]
        [int]$Finish,

        [Parameter(Mandatory = $true, Position = 4)]
        [ValidateRange(0, [long]::MaxValue)]
        [long]$Size
    )

    if ($Start -gt $Finish) { return }

    $baseTime = Get-Date

    foreach ($i in $Start..$Finish) {
        $stamp = $baseTime.AddDays(-$i)
        $dateStr = $stamp.ToString('yyyy-MM-dd-HH-mm-ss-fff')
        $file = "{0}-{1}{2}" -f $Prefix, $dateStr, $Suffix

        $action = "Create/overwrite file, set size=$Size bytes, set LastWriteTime=$($stamp.ToString('yyyy-MM-dd HH:mm:ss'))"
        if (-not $PSCmdlet.ShouldProcess($file, $action)) {
            continue
        }

        $fs = $null
        try {
            $fs = [System.IO.File]::Open(
                $file,
                [System.IO.FileMode]::Create,
                [System.IO.FileAccess]::Write,
                [System.IO.FileShare]::None
            )
            $fs.SetLength($Size)
        }
        finally {
            if ($fs) { $fs.Dispose() }
        }

        (Get-Item -LiteralPath $file).LastWriteTime = $stamp
    }
}
